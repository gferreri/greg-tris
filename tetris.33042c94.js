parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"pwmo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BoxDefinition=[{initialPosition:[7,0],rotations:[[0,0],[0,0],[0,0],[0,0]]},{initialPosition:[7,1],rotations:[[0,0],[0,0],[0,0],[0,0]]},{initialPosition:[6,0],rotations:[[0,0],[0,0],[0,0],[0,0]]},{initialPosition:[6,1],rotations:[[0,0],[0,0],[0,0],[0,0]]}];
},{}],"Bx8K":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BarDefinition=[{initialPosition:[7,0],rotations:[[1,1],[-1,2],[-2,-2],[2,-1]]},{initialPosition:[7,1],rotations:[[0,0],[0,1],[-1,-1],[1,0]]},{initialPosition:[7,2],rotations:[[-1,-1],[1,0],[0,0],[0,1]]},{initialPosition:[7,3],rotations:[[-2,-2],[2,-1],[1,1],[-1,2]]}];
},{}],"zLoW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LDefinition=[{initialPosition:[6,0],rotations:[[2,0],[-1,2],[-1,-1],[0,-1]]},{initialPosition:[6,1],rotations:[[1,-1],[0,1],[0,0],[-1,0]]},{initialPosition:[6,2],rotations:[[0,-2],[1,0],[1,1],[-2,1]]},{initialPosition:[7,2],rotations:[[-1,-1],[0,-1],[2,0],[-1,2]]}];
},{}],"RMA4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,o,i,n){this.x=t,this.y=o,this.color=i,this.rotations=n,this.rotationIndex=0}return t.prototype.rotate=function(t){var o=this.rotations[this.rotationIndex][1],i=this.rotations[this.rotationIndex][0];t||(o*=1,i*=1),this.x+=i,this.y+=o,this.rotationIndex=(this.rotationIndex+1)%4},t}();exports.Square=t;
},{}],"eKDL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.boardWidth=500,exports.columnsCount=15,exports.rowCount=24,exports.squareLength=exports.boardWidth/exports.columnsCount;
},{}],"YoFF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=require("./constants"),t=function(){function t(o){this.board=o,this.squares=[]}return t.prototype.rotate=function(o){this.clearPreviousBoardPosition();for(var t=0,r=this.squares;t<r.length;t++){var e=r[t];e.rotate(o),e.x>=0&&e.y>=0&&(this.board.rows[e.y].columns[e.x]=e)}},t.prototype.clearPreviousBoardPosition=function(){for(var o=0,t=this.squares;o<t.length;o++){var r=t[o];r.x>=0&&r.y>=0&&(this.board.rows[r.y].columns[r.x]=null)}},t.prototype.isValidMove=function(t,r){if(r>=0&&r<o.rowCount&&t>=0&&t<o.columnsCount){var e=this.board.rows[r].columns[t];return null===e||this.squares.indexOf(e)>=0}return!1},t.prototype.move=function(o,t){var r=this;if(this.squares.every(function(e){return r.isValidMove(e.x+o,e.y+t)})){this.clearPreviousBoardPosition();for(var e=0,s=this.squares;e<s.length;e++){var i=s[e];i.x+=o,i.y+=t,this.board.rows[i.y].columns[i.x]=i}return!0}return!1},t.prototype.moveRight=function(){this.move(1,0)},t.prototype.moveLeft=function(){this.move(-1,0)},t.prototype.descend=function(){return this.move(0,1)},t}();exports.Piece=t;
},{"./constants":"eKDL"}],"nH6z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var i=require("./pieceDefinitions/BoxDefinition"),e=require("./pieceDefinitions/BarDefinition"),n=require("./pieceDefinitions/LDefinition"),r=require("./Square"),t=require("./Piece"),o=["#1E1E24","#FB9F89","#C4AF9A","#81AE9D","#21A179"],a=[n.LDefinition,e.BarDefinition,i.BoxDefinition],s=function(){function i(i){this.board=i}return i.prototype.getNextPiece=function(){var i=new t.Piece(this.board),e=o[Math.floor(Math.random()*o.length)],n=a[Math.floor(Math.random()*a.length)];i.squares=n.map(function(i){return new r.Square(i.initialPosition[0],i.initialPosition[1],e,i.rotations)});for(var s=0,u=i.squares;s<u.length;s++){var f=u[s];this.board.rows[f.y].columns[f.x]=f}return i},i}();exports.PieceFactory=s;
},{"./pieceDefinitions/BoxDefinition":"pwmo","./pieceDefinitions/BarDefinition":"Bx8K","./pieceDefinitions/LDefinition":"zLoW","./Square":"RMA4","./Piece":"YoFF"}],"yp1Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./constants"),n=function(){return function(){this.columns=[];for(var n=0;n<r.columnsCount;n++)this.columns.push(null)}}();exports.Row=n;var o=function(){function o(){this.rows=[];for(var o=0;o<r.rowCount;o++)this.rows.push(new n)}return o.prototype.processCompleteRows=function(){var r=this,o=this.rows.map(function(r,n){return r.columns.every(function(r){return!!r})?n:-1}).filter(function(r){return r>=0});return o.forEach(function(o){r.rows.splice(o,1),r.rows.unshift(new n)}),o},o}();exports.Board=o;
},{"./constants":"eKDL"}],"jU8R":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(t){a(t)}}function c(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}u((r=r.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(exports,"__esModule",{value:!0});var n,r=require("./PieceFactory"),o=require("./Board"),a=require("./constants"),i=new o.Board;function c(n){return e(this,void 0,void 0,function(){var e,r,o;return t(this,function(t){return e=h(),r=e.canvas.width/2,o=a.squareLength*n,[2,new Promise(function(t){!function n(i){return setTimeout(function(){e.clearRect(r-i/2,o,i,a.squareLength),(i+=e.canvas.width/20)<e.canvas.width?n(i):t()},10)}(10)})]})})}function u(){for(var e=h(),t=0,n=0,r=i.rows;n<r.length;n++){for(var o=0,c=0,u=r[n].columns;c<u.length;c++){var s=u[c];e.lineWidth=2;var l=t*a.squareLength,d=o*a.squareLength;s?(e.beginPath(),e.fillStyle=s.color,e.rect(d,l,a.squareLength,a.squareLength),e.stroke(),e.fill()):e.clearRect(d,l,a.squareLength,a.squareLength),o++}t++}document.getElementById("score").innerText=f.toString()}var s,l=new r.PieceFactory(i),f=0;function h(){return document.getElementById("board").getContext("2d")}function d(){s=window.setInterval(v,750)}function w(){window.clearInterval(s),s=null}function v(){return e(this,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:return w(),n.descend()?[3,2]:(e=i.processCompleteRows(),f+=100*e.length,4===e.length&&(f+=500),[4,Promise.all(e.map(c))]);case 1:t.sent(),n=l.getNextPiece(),t.label=2;case 2:return u(),d(),[2]}})})}window.onload=function(){n=l.getNextPiece(),u(),d()},window.onkeydown=function(e){switch(e.code){case"Space":n.rotate(!0);break;case"KeyL":case"ArrowRight":n.moveRight();break;case"KeyJ":case"ArrowLeft":n.moveLeft();break;case"KeyK":n.descend();break;case"KeyP":null!==s?w():d()}u()};
},{"./PieceFactory":"nH6z","./Board":"yp1Z","./constants":"eKDL"}]},{},["jU8R"], null)
//# sourceMappingURL=tetris.33042c94.js.map